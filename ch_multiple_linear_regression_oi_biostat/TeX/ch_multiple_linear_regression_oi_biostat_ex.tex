%!TEX root=../../main.tex

\section{Exercises}

% Chapter 7 exercises
% 
% many problems drawn from OI 4 source files
%__________________
\subsection{Single vs multiple regression}

% current commented numbers are from oi4 and  our current sequence

% oibio 1
% oi4 1

\eoce{\qt{Baby weights, Part I\label{baby_weights_smoke}} The Child Health 
and Development Studies investigate a range of topics. One study 
considered all pregnancies between 1960 and 1967 among women in the 
Kaiser Foundation Health Plan in the San Francisco East Bay area. Here, 
we study the relationship between smoking and weight of the baby. The 
variable \texttt{smoke} is coded 1 if the mother is a smoker, and 0 if 
not. The summary table below shows the results of a linear regression 
model for predicting the average birth weight of babies, measured in 
ounces, based on the smoking status of the mother. 
\footfullcite{data:babies}
\begin{center}
\begin{tabular}{rrrrr}
  \hline
            & Estimate  & Std. Error  & t value   & Pr($>$$|$t$|$) \\ 
  \hline
(Intercept) & 123.05    & 0.65        & 189.60    & 0.0000 \\ 
smoke       & -8.94     & 1.03        & -8.65     & 0.0000 \\ 
  \hline
\end{tabular}
\end{center}
The variability within the smokers and non-smokers are about equal and the 
distributions are symmetric. With these conditions satisfied, it is reasonable 
to apply the model. (Note that we don't need to check linearity since the 
predictor has only two levels.)
\begin{parts}
\item Write the equation of the regression model.
\item Interpret the slope in this context, and calculate the predicted birth 
weight of babies born to smoker and non-smoker mothers.
\item Is there a statistically significant relationship between the average birth 
weight and smoking?
\end{parts}
}{}

% oibio 2
% oi4 2

\eoce{\qt{Baby weights, Part II\label{baby_weights_parity}} 
Exercise~\ref{baby_weights_smoke} introduces a data set
on birth weight of babies.
Another variable we consider is \texttt{parity},
which is 1 if the child is the first born,
and 0 otherwise.
The summary table below shows the results of
a linear regression model for predicting the
average birth weight of babies, measured in ounces,
from \texttt{parity}. 
\begin{center}
\begin{tabular}{rrrrr}
  \hline
            & Estimate  & Std. Error    & t value   & Pr($>$$|$t$|$) \\ 
  \hline
(Intercept) & 120.07    & 0.60        & 199.94    & 0.0000 \\ 
parity      	& -1.93     	  & 1.19        & -1.62       & 0.1052 \\ 
  \hline
\end{tabular}
\end{center}
\begin{parts}
\item Write the equation of the regression model.
\item Interpret the slope in this context, and calculate the predicted birth 
weight of first borns and others.
\item Is there a statistically significant relationship between the average 
birth weight and parity?
\end{parts}
}{}

% oibio 3
% oi4 6

\eoce{\qt{Cherry trees\label{cherry_trees}} Timber yield is approximately equal to the 
volume of a tree, however, this value is difficult to measure without first 
cutting the tree down. Instead, other variables, such as height and diameter, 
may be used to predict a tree's volume and yield. Researchers wanting to 
understand the relationship between these variables for black cherry trees 
collected data from 31 such trees in the Allegheny National Forest, 
Pennsylvania. Height is measured in feet, diameter in inches (at 54 inches above 
ground), and volume in cubic feet.\footfullcite{Hand:1994}
\begin{table}[ht]
\begin{center}
\begin{tabular}{rrrrr}
  \hline
            & Estimate  & Std. Error  & t value   & Pr($>$$|$t$|$) \\ 
  \hline
(Intercept) & -57.99    & 8.64        & -6.71     & 0.00 \\ 
height      & 0.34      & 0.13        & 2.61      & 0.01 \\ 
diameter    & 4.71      & 0.26        & 17.82     & 0.00 \\ 
  \hline
\end{tabular}
\end{center}
\end{table}
\begin{parts}
\item Calculate a 95\% confidence interval for the coefficient of height, and 
interpret it in the context of the data.
\item One tree in this sample is 79 feet tall, has a diameter of 11.3 inches, 
and is 24.2 cubic feet in volume. Determine if the model overestimates or 
underestimates the volume of this tree, and by how much.
\end{parts}
}{}
\subsection{Evaluating the fit of a multiple regression model}

% oibio 4
% oi4 3

\eoce{\qt{Baby weights, Part III\label{baby_weights_mlr}} We considered the 
variables \texttt{smoke} and \texttt{parity}, one at a time, in modeling birth 
weights of babies in Exercises~\ref{baby_weights_smoke} and~\ref{baby_weights_parity}. 
A more realistic approach to modeling infant 
weights is to consider all possibly related variables at once. Other variables 
of interest include length of pregnancy in days (\texttt{gestation}), mother's 
age in years (\texttt{age}), mother's height in inches (\texttt{height}), and 
mother's pregnancy weight in pounds (\texttt{weight}). Below are three 
observations from this data set. 
\begin{center}
\begin{tabular}{r c c c c c c c}
  \hline
      & bwt & gestation & parity  & age   & height  & weight  & smoke \\ 
  \hline
1     & 120 & 284       & 0       & 27    &  62     & 100     &   0 \\ 
2     & 113 & 282       & 0       & 33    &  64     & 135     &   0 \\ 
$\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ &  $\vdots$ & $\vdots$ & $\vdots$ &   $\vdots$ \\ 
1236  & 117 & 297       & 0       & 38    &  65     & 129     &   0 \\ 
   \hline
\end{tabular}
\end{center}
The summary table below shows the results of a regression model for predicting 
the average birth weight of babies based on all of the variables included in 
the data set.
\begin{center}
\begin{tabular}{rrrrr}
  \hline
            & Estimate  & Std. Error  & t value   & Pr($>$$|$t$|$) \\ 
  \hline
(Intercept) & -80.41    & 14.35       & -5.60     & 0.0000 \\ 
gestation   & 0.44      & 0.03        & 15.26     & 0.0000 \\ 
parity      & -3.33     & 1.13        & -2.95     & 0.0033 \\ 
age         & -0.01     & 0.09        & -0.10     & 0.9170 \\ 
height      & 1.15      & 0.21        & 5.63      & 0.0000 \\ 
weight      & 0.05      & 0.03        & 1.99      & 0.0471 \\ 
smoke       & -8.40     & 0.95        & -8.81     & 0.0000 \\ 
  \hline
\end{tabular}
\end{center}
\begin{parts}
\item Write the equation of the regression model that includes all of the 
variables.
\item Interpret the slopes of \texttt{gestation} and \texttt{age} in this 
context.
\item The coefficient for \texttt{parity} is different than in the linear 
model shown in Exercise~\ref{baby_weights_parity}. Why might there be a difference?
\item Calculate the residual for the first observation in the data set.
\item The variance of the residuals is 249.28, and the variance of the birth 
weights of all babies in the data set is 332.57. Calculate the $R^2$ and the 
adjusted $R^2$. Note that there are 1,236 observations in the data set.
\end{parts}
}{}

% oibio 5
% oi4 4

\eoce{\qt{Absenteeism, Part I\label{absent_from_school_mlr}} Researchers interested in the 
relationship between absenteeism from school and certain demographic 
characteristics of children collected data from 146 randomly sampled students 
in rural New South Wales, Australia, in a particular school year. Below are 
three observations from 
this data set. 
\begin{center}
\begin{tabular}{r c c c c}
  \hline
 	  & eth 	& sex 	& lrn 	& days \\   
  \hline
1 	& 0 		& 1 		& 1 		&   2 \\ 
2 	& 0 		& 1 		& 1 		&  11 \\ 
$\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ \\ 
146 & 1 		& 0 		& 0 		&  37 \\ 
  \hline
\end{tabular}
\end{center}
The summary table below shows the results of a linear regression model for 
predicting the average number of days absent based on ethnic background 
(\texttt{eth}: 0 - aboriginal, 1 - not aboriginal), sex (\texttt{sex}: 0 - 
female, 1 - male), and learner status (\texttt{lrn}: 0 - average learner, 1 - 
slow learner). \footfullcite{data:quine}
\begin{center}
\begin{tabular}{rrrrr}
  \hline
            & Estimate  & Std. Error  & t value   & Pr($>$$|$t$|$) \\ 
  \hline
(Intercept) & 18.93     & 2.57        & 7.37      & 0.0000 \\ 
eth         & -9.11     & 2.60        & -3.51     & 0.0000 \\ 
sex         & 3.10      & 2.64        & 1.18      & 0.2411 \\ 
lrn         & 2.15      & 2.65        & 0.81      & 0.4177 \\ 
  \hline
\end{tabular}
\end{center}
\begin{parts}
\item Write the equation of the regression model.
\item Interpret each one of the slopes in this context.
\item Calculate the residual for the first observation in the data set: a 
student who is aboriginal, male, a slow learner, and missed 2 days of school.
\item The variance of the residuals is 240.57, and the variance of the number of 
absent days for all students in the data set is 264.17. Calculate the $R^2$ and 
the adjusted $R^2$. Note that there are 146 observations in the data set.
\end{parts}
}{}

% oibio 6
% oi4 5

\eoce{\qt{GPA\label{gpa}} A survey of 55 Duke University students asked about their 
GPA, number of hours they study at night, number of nights they go out, and 
their gender. Summary output of the regression model is shown below. Note that 
male is coded as 1. 
\begin{center}
\begin{tabular}{rrrrr}
  \hline
            & Estimate  & Std. Error  & t value   & Pr($>$$|$t$|$) \\ 
  \hline
(Intercept) & 3.45      & 0.35        & 9.85      & 0.00 \\ 
studyweek   & 0.00      & 0.00        & 0.27      & 0.79 \\ 
sleepnight  & 0.01      & 0.05        & 0.11      & 0.91 \\ 
outnight    & 0.05      & 0.05        & 1.01      & 0.32 \\ 
gender      & -0.08     & 0.12        & -0.68     & 0.50 \\ 
  \hline
\end{tabular}
\end{center}
\begin{parts}
\item Calculate a 95\% confidence interval for the coefficient of gender in the 
model, and interpret it in the context of the data.
\item Would you expect a 95\% confidence interval for the slope of the remaining 
variables to include 0? Explain
\end{parts}
}{}

% oibio 7
% oi4 13

\eoce{\qt{Baby weights, Part VI\label{baby_weights_conds}} 
Exercise~\ref{baby_weights_mlr} presents a regression model for predicting the 
average birth weight of babies based on length of gestation, parity, height, 
weight, and smoking status of the mother. Determine if the model assumptions are 
met using the plots below. If not, describe how to proceed with the analysis.
\newcommand{\babyplot}[1]{\includegraphics[width=0.4\textwidth]{ch_multiple_linear_regression_oi_biostat/figures/eoce/baby_weights_conds/#1}\hspace{5mm}}
\begin{center}
\babyplot{baby_weights_conds_normal_hist}
\babyplot{baby_weights_conds_abs_res_fitted}
\babyplot{baby_weights_conds_res_order}
\babyplot{baby_weights_conds_res_gestation}
\babyplot{baby_weights_conds_res_parity}
\babyplot{baby_weights_conds_res_height}
\babyplot{baby_weights_conds_res_weight}
\babyplot{baby_weights_conds_res_smoke}
\end{center}
}{}

% oibio 8
% oi4 19

\eoce{\qt{Multiple regression fact checking\label{mult_regr_facts}}
Determine which of the following statements are
true and false.
For each statement that is false, explain why it is false.
\begin{parts}
\item
    If predictors are collinear, then removing
    one variable will have no influence on the
    point estimate of another variable's coefficient.
\item
    Suppose a numerical variable $x$ has a coefficient of
    $b_1 = 2.5$ in the multiple regression model.
    Suppose also that the first observation has $x_1 = 7.2$,
    the second observation has a value of $x_1 = 8.2$,
    and these two observations have the same values
    for all other predictors.
    Then the predicted value of the second observation
    will be 2.5 higher than the prediction of the first
    observation based on the multiple regression model.
\item
    If a regression model's first variable has
    a coefficient of $b_1 = 5.7$, then if we are
    able to influence the data so that an observation
    will have its $x_1$ be 1 larger than it would
    otherwise, the value $y_1$ for this observation
    would increase by 5.7.
\item
    Suppose we fit a multiple regression model
    based on a data set of 472 observations.
    We also notice that the distribution of the
    residuals includes some skew but does not
    include any particularly extreme outliers.
    Because the residuals are not nearly normal,
    we should not use this model and require
    more advanced methods to model these data.
\end{parts}
}{}


